{"exportVersion":6,"dashboards":{"dashboard-1":{"description":"","embedding":{},"filters":[],"layout":[{"i":"item-1","w":2,"h":2,"x":0,"y":0},{"i":"item-2","w":2,"h":2,"x":2,"y":0},{"i":"item-3","w":2,"h":2,"x":4,"y":0},{"i":"item-4","w":2,"h":2,"x":6,"y":0},{"i":"item-5","w":2,"h":2,"x":0,"y":2},{"i":"item-6","w":2,"h":2,"x":2,"y":2},{"i":"item-7","w":2,"h":2,"x":4,"y":2},{"i":"item-8","w":2,"h":2,"x":6,"y":2},{"i":"item-9","w":2,"h":2,"x":0,"y":4}],"title":"Santa Dashboard"}},"items":{"item-1":{"calculatedFields":[],"channels":{"x":{"channelType":"category","field":"ScheduleDate","inferredType":"Date","type":"nominal","isBinning":true,"temporalBinning":["year","month","date"]},"y":{"channelType":"aggregation","field":"AverageOfPersons","inferredType":"Number","type":"quantitative","aggregate":"sum"}},"chartType":"Line","convertedFields":[],"customisations":{"options":{},"conditionalFormatting":[],"axes":{"x":{"categoryLabelAngle":{"enabled":true,"value":"vertical"}},"y":{}},"channels":{"x":{"dateTimeFormatting":{"enabled":true,"value":"DD-MMM-YYYY"}},"y":{"numberFormatting":{"enabled":true,"value":"Default"}}}},"dashboardId":"dashboard-1","dataSourceId":"data-source-1","description":"Line chart","filters":[],"iconValue":"line-discrete","interactiveFiltering":"highlight","itemType":"chart","lookupFields":[],"meta":{},"missedFields":[],"query":"[\n  {\n    $group: {\n      _id: { ScheduleDate: \"$ScheduleDate\" },\n      average: { $avg: \"$NumberOfMembers\" }\n    }\n  },\n  {\n    $project: {\n        _id: 0,\n        ScheduleDate: \"$_id.ScheduleDate\",\n        AverageOfPersons: \"$average\"\n    }\n  }\n]","reductions":{},"sample":false,"title":"Average of persons per day","queryId":null,"embedding":{}},"item-2":{"calculatedFields":[],"channels":{"y":{"channelType":"aggregation","field":"Cancelations","inferredType":"Number","type":"quantitative","aggregate":"sum"},"x":{"channelType":"category","field":"ScheduleDate","inferredType":"Date","type":"nominal","isBinning":true,"temporalBinning":["year","month","date"]}},"chartType":"Line","convertedFields":[],"customisations":{"options":{},"axes":{"x":{"categoryLabelAngle":{"enabled":true,"value":"vertical"}},"y":{}},"channels":{"y":{"numberFormatting":{"enabled":true,"value":"Default"}},"x":{"dateTimeFormatting":{"enabled":true,"value":"DD-MMM-YYYY"}}},"conditionalFormatting":[]},"dashboardId":"dashboard-1","dataSourceId":"data-source-1","description":"Line chart","filters":[],"iconValue":"line-discrete","interactiveFiltering":"highlight","itemType":"chart","lookupFields":[],"meta":{},"missedFields":[],"query":"[{\n\t$addFields:{\n\t\tCancelations:{\n\t\t\t$sum:1\n\t\t}\n\t}\n}\n,{\n\t$match:{\n\t\tCanceled:{\n\t\t\t$eq:true\n\t\t}\n\t}\n}\n,{\n\t$project:{\n\t\tScheduleDate:1,Cancelations:1,_id:0\n\t}\n}\n]","reductions":{},"sample":false,"title":"Number of cancellations per day","queryId":null,"embedding":{}},"item-3":{"calculatedFields":[],"channels":{"value":{"channelType":"aggregation","field":"percentage","inferredType":"Number","type":"quantitative","aggregate":"sum"},"label":{"channelType":"category","field":"_id","inferredType":"Date","type":"nominal","isBinning":true,"temporalBinning":["year","month","date"],"allOthers":true}},"chartType":"Donut","convertedFields":[],"customisations":{"options":{"dataValueLabels":{"enabled":false,"value":"value"}},"axes":{},"channels":{"value":{"numberFormatting":{"enabled":true,"value":"Default"}},"label":{"dateTimeFormatting":{"enabled":true,"value":"DD-MMM-YYYY"}}},"conditionalFormatting":[]},"dashboardId":"dashboard-1","dataSourceId":"data-source-1","description":"Circular Char","filters":[],"iconValue":"donut","interactiveFiltering":"highlight","itemType":"chart","lookupFields":[],"meta":{},"missedFields":[],"query":"[{\n\t$group:{\n\t\t_id:\"$ScheduleDate\",percentage:{\n\t\t\t$sum:{\n\t\t\t\t$multiply:[{$divide:[1,50]\n\t\t\t}\n\t\t\t,100]}\n\t\t}\n\t}\n}\n]","reductions":{},"sample":false,"title":"Percentage of occupation per day","queryId":null,"embedding":{}},"item-4":{"calculatedFields":[],"channels":{"y":{"channelType":"aggregation","field":"Bookings","inferredType":"Number","type":"quantitative","aggregate":"sum"},"x":{"channelType":"category","field":"CountryAndCity.country","inferredType":"String","type":"nominal","isBinning":false}},"chartType":"Grouped Column","convertedFields":[],"customisations":{"options":{},"axes":{"x":{"categoryLabelAngle":{"enabled":true,"value":"vertical"}},"y":{}},"channels":{"y":{"numberFormatting":{"enabled":true,"value":"Default"}},"x":{}},"conditionalFormatting":[]},"dashboardId":"dashboard-1","dataSourceId":"data-source-1","description":"Column chart","filters":[],"iconValue":"column-grouped","interactiveFiltering":"highlight","itemType":"chart","lookupFields":[],"meta":{},"missedFields":[],"query":"[{\n\t$group:{\n\t\t_id:{\n\t\t\tcountry:\"$Country\",city:\"$City\"\n\t\t}\n\t\t,count:{\n\t\t\t$sum:1\n\t\t}\n\t}\n}\n,{\n\t$project:{\n\t\t_id:0,CountryAndCity:\"$_id\",Bookings:\"$count\"\n\t}\n}\n]","reductions":{},"sample":false,"title":"Total bookings country","queryId":null,"embedding":{}},"item-5":{"calculatedFields":[],"channels":{"x":{"channelType":"category","field":"CountryAndCity.city","inferredType":"String","type":"nominal","isBinning":false},"y":{"channelType":"aggregation","field":"Bookings","inferredType":"Number","type":"quantitative","aggregate":"sum"}},"chartType":"Grouped Column","convertedFields":[],"customisations":{"options":{},"axes":{"x":{"categoryLabelAngle":{"enabled":true,"value":"vertical"}},"y":{}},"channels":{"x":{},"y":{"numberFormatting":{"enabled":true,"value":"Default"}}},"conditionalFormatting":[]},"dashboardId":"dashboard-1","dataSourceId":"data-source-1","description":"Column chart","filters":[],"iconValue":"column-grouped","interactiveFiltering":"highlight","itemType":"chart","lookupFields":[],"meta":{},"missedFields":[],"query":"[{$group:{\n\t_id:{\n\t\tcountry:\"$Country\",city:\"$City\"\n\t}\n\t,count:{\n\t\t$sum:1\n\t}\n}\n}\n,{\n$project:{\n\t_id:0,CountryAndCity:\"$_id\",Bookings:\"$count\"\n}\n}\n]","reductions":{},"sample":false,"title":"Total bookings per city","queryId":null,"embedding":{}},"item-6":{"calculatedFields":[],"channels":{"y":{"channelType":"aggregation","field":"BookingsUntilTotal","inferredType":"Number","type":"quantitative","aggregate":"sum"}},"chartType":"Grouped Column","convertedFields":[],"customisations":{"axes":{"y":{}},"conditionalFormatting":[],"channels":{"y":{"numberFormatting":{"enabled":true,"value":"Default"}}},"options":{"dataValueLabels":{"enabled":false,"value":"value"}}},"dashboardId":"dashboard-1","dataSourceId":"data-source-1","description":"Column chart","filters":[],"iconValue":"column-grouped","interactiveFiltering":"highlight","itemType":"chart","lookupFields":[],"meta":{},"missedFields":[],"query":"[\n    {\n        $match: {\n            ScheduleDate: {$lte: new ISODate()}\n        }\n    },\n    {\n        $group: {\n            _id: null,\n            bookings: {$sum: 1}\n        }\n    },\n    {\n        $project: {\n            BookingsUntilTotal: \"$bookings\",\n            _id: 0\n        }\n    }\n]","reductions":{},"sample":false,"title":"Sum of bookings until today","queryId":null,"embedding":{}},"item-7":{"calculatedFields":[],"channels":{"x":{"channelType":"category","field":"ScheduleDate","inferredType":"Date","type":"nominal","isBinning":true,"temporalBinning":["year","month","date"]},"y":{"channelType":"aggregation","field":"TotalFamiliesPerDay","inferredType":"Number","type":"quantitative","aggregate":"sum"}},"chartType":"Line","convertedFields":[],"customisations":{"options":{},"axes":{"x":{"categoryLabelAngle":{"enabled":true,"value":"vertical"}},"y":{}},"channels":{"x":{"dateTimeFormatting":{"enabled":true,"value":"DD-MMM-YYYY"}},"y":{"numberFormatting":{"enabled":true,"value":"Default"}}},"conditionalFormatting":[]},"dashboardId":"dashboard-1","dataSourceId":"data-source-1","description":"Line Chart","filters":[],"iconValue":"line-discrete","interactiveFiltering":"highlight","itemType":"chart","lookupFields":[],"meta":{},"missedFields":[],"query":"[\n    {\n        $group: {\n            _id: {\"ScheduleDate\": \"$ScheduleDate\"},\n            familiesPerDay: {$sum: 1}\n        }\n    },\n    {\n        $project: {\n            TotalFamiliesPerDay: \"$familiesPerDay\",\n            ScheduleDate: \"$_id.ScheduleDate\",\n            _id: 0\n        }\n    }\n]","reductions":{},"sample":false,"title":"Total of Families per day","queryId":null,"embedding":{}},"item-8":{"calculatedFields":[],"channels":{"x":{"channelType":"category","field":"ScheduleDate","inferredType":"Date","type":"nominal","isBinning":true,"temporalBinning":["year","month","date"]},"y":{"channelType":"aggregation","field":"Members","inferredType":"Number","type":"quantitative","aggregate":"sum"}},"chartType":"Line","convertedFields":[],"customisations":{"options":{},"axes":{"x":{"categoryLabelAngle":{"enabled":true,"value":"vertical"}},"y":{}},"channels":{"x":{"dateTimeFormatting":{"enabled":true,"value":"DD-MMM-YYYY"}},"y":{"numberFormatting":{"enabled":true,"value":"Default"}}},"conditionalFormatting":[]},"dashboardId":"dashboard-1","dataSourceId":"data-source-1","description":"Line chart","filters":[],"iconValue":"line-discrete","interactiveFiltering":"highlight","itemType":"chart","lookupFields":[],"meta":{},"missedFields":[],"query":"[{\n\t$group:{\n\t\t_id:{\n\t\t\t\"ScheduleDate\":\"$ScheduleDate\"\n\t\t}\n\t\t,membersPerDay:{\n\t\t\t$sum:\"$NumberOfMembers\"\n\t\t}\n\t}\n}\n,{\n\t$project:{\n\t\tMembers:\"$membersPerDay\",ScheduleDate:\"$_id.ScheduleDate\",_id:0\n\t}\n}\n]","reductions":{},"sample":false,"title":"Total of persons per day","queryId":null,"embedding":{}},"item-9":{"calculatedFields":[],"channels":{"y":{"channelType":"category","field":"age","inferredType":"String","type":"nominal","isBinning":false},"x":{"channelType":"aggregation","field":"persons","inferredType":"Number","type":"quantitative","aggregate":"sum"}},"chartType":"Grouped Bar","convertedFields":[],"customisations":{"axes":{"x":{}},"conditionalFormatting":[],"channels":{"y":{},"x":{"numberFormatting":{"enabled":true,"value":"Default"}}},"options":{}},"dashboardId":"dashboard-1","dataSourceId":"data-source-1","description":"Bar chart","filters":[],"iconValue":"bar-grouped","interactiveFiltering":"highlight","itemType":"chart","lookupFields":[],"meta":{},"missedFields":[],"query":"[\n    { \"$unwind\": \"$Members\" },\n    {\n         \"$project\": {\n            \"age\": {\n                \"$divide\": [\n                    {\n                        \"$subtract\": [\n                            new Date(),\n                            { \"$ifNull\": [\"$Members.Birthday\", new Date()] }\n                        ]\n                    },\n                    1000 * 86400 * 365\n                ]\n            }\n        }\n    },\n    {\n        \"$group\": {\n            \"_id\": {\n                \"$concat\": [\n                    { \"$cond\": [ { \"$lte\": [ \"$age\", 0 ] }, \"Unknown\", \"\"] },\n                    { \"$cond\": [ { \"$and\": [ { \"$gt\":  [\"$age\", 0 ] }, { \"$lt\": [\"$age\", 18] } ]}, \"Under 18\", \"\"] },\n                    { \"$cond\": [ { \"$and\": [ { \"$gte\": [\"$age\", 18] }, { \"$lt\": [\"$age\", 25] } ]}, \"19 - 35\", \"\"] },\n                    { \"$cond\": [ { \"$and\": [ { \"$gte\": [\"$age\", 25] }, { \"$lt\": [\"$age\", 35] } ]}, \"26 - 35\", \"\"] },\n                    { \"$cond\": [ { \"$and\": [ { \"$gte\": [\"$age\", 35] }, { \"$lt\": [\"$age\", 45] } ]}, \"36 - 45\", \"\"] },\n                    { \"$cond\": [ { \"$gte\": [ \"$age\", 45 ] }, \"Over 46\", \"\"] }\n                ]\n            },\n            \"persons\": { \"$sum\": 1 }\n        }\n    },\n    { \"$project\": { \"_id\": 0, \"age\": \"$_id\", \"persons\": 1 } }\n]","reductions":{},"sample":false,"title":"Number of persons by age group","queryId":null,"embedding":{}}},"dataSources":{"data-source-1":{"alias":"SantaDB.Bookings","collection":"Bookings","database":"SantaDB","deployment":"Cluster0","sourceType":"cluster"}},"queries":{}}